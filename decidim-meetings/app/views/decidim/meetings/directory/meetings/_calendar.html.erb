<%# REDESIGN_PENDING: include links %>
<div class="meeting-calendar__selector-container">
  <div class="meeting-calendar__selector">
    <a href="" class="meeting-calendar__selector-arrow">
      <%= icon "arrow-left-s-line", class: "w-6 h-6 text-secondary fill-current" %>
    </a>
    <h2 class="h2">2020</h2>
    <a href="" class="meeting-calendar__selector-arrow">
      <%= icon "arrow-right-s-line", class: "w-6 h-6 text-secondary fill-current" %>
    </a>
  </div>
  <a href="" class="meeting-calendar__link">
    <%= "See event list" %>
    <%= icon "list-check-2", class: "w-3.5 h-3.5 text-secondary fill-current" %>
  </a>
</div>

<div class="meeting-calendar">
  <%
    # REDESING_PENDING: integrate the actual current year

    current_year = Date.new(2022,1,1).all_year;
    events = Date.new(2022,1,1).all_year.to_a.sample(15);
  %>

  <% current_year.group_by {|e| e.month}.each do |month| %>
    <table class="meeting-calendar__month">
      <caption><%= Date::MONTHNAMES[month[0]] %></caption>
      <thead>
        <%
          # REDESIGN_PENDING: translatable day/months
          Date::ABBR_DAYNAMES.each do |day| %>
          <th><%= day %></th>
        <% end %>
      </thead>
      <tbody>
        <% month[1].group_by {|e| l e, format: "%U"}.each do |week| %>
          <tr>
            <% if l(week[1].first, format: "%d") == "01" %>
              <% (7 - week[1].length).times do %>
                <td></td>
              <% end %>
            <% end %>
            <% week[1].each do |day| %>
              <%
                # REDESIGN_PENDING: create a controller function to get the css class
                classes = []

                classes << "is-today" if day == Date.today
                classes << "is-past-event" if events.include? day and day < Date.today
                classes << "is-future-event" if events.include? day and day > Date.today
              %>
              <td class="<%= classes.join(" ") %>"><%= l day, format: "%d" %></td>
            <% end %>
            <% if l(week[1].first, format: "%d") != "01" %>
              <% (7 - week[1].length).times do %>
                <td></td>
              <% end %>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% end %>
</div>
